<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>트레이너 목록</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

</head>

<body class="bg-gray-200">
    <!-- 헤더 -->
    <header class="relative grid grid-cols-3 items-center bg-gray-800 text-white p-6 shadow-lg h-28">
        <!-- 왼쪽 빈 공간 (로고 가운데 정렬용) -->
        <div></div>

        <!-- 로고 (가운데 정렬) -->
        <a class="flex justify-center">
            <img src="../../static/images/logo.png" th:src="@{/images/logo.png}" 
                 alt="Logo" class="w-[250px] object-contain">
        </a>

        <!-- 우측 버튼 -->
        <div class="flex justify-end items-center gap-6">
            <div id="user">
                <ul class="flex gap-4">
                    <!-- 인증하지 않은 사용자 -->
                    <th:block sec:authorize="isAnonymous()">
                        <li>
                            <a th:href="@{/user/login}">
                                <button class="bg-blue-600 px-5 py-3 rounded-lg hover:bg-opacity-40 transition">
                                    로그인
                                </button>
                            </a>
                        </li>
                    </th:block>

                    <!-- 인증한 사용자  -->
                    <th:block sec:authorize="isAuthenticated()">
                        <div x-data="{ open: false, isOpen: false }" class="relative inline-block text-left">
                            <!-- 메인 버튼 -->
                            <section class="flex items-center space-x-1">
                                <!-- 버튼 -->
                                <button @click="open = !open" 
                                    class="px-5 py-3 rounded-lg hover:bg-opacity-40 transition">
                                    <span class="text-2xl" th:text="${#authentication.name}"></span>
                                </button>
                            
                                <!-- 프로필 이미지 (클릭 시 버튼과 동일한 효과) -->
                                <img src="../../static/images/user.png" th:src="@{/images/user.png}" 
                                    alt="Profile" class="w-10 h-10 rounded-full cursor-pointer bg-white" 
                                    @click="open = !open">
                            </section>
                    
                            <!-- 드롭다운 메뉴 -->
                            <div x-show="open" @click.away="open = false" 
                                x-transition:enter="transition ease-out duration-200 transform opacity-0 scale-95"
                                x-transition:enter-start="opacity-0 scale-95"
                                x-transition:enter-end="opacity-100 scale-100"
                                x-transition:leave="transition ease-in duration-150 transform opacity-100 scale-100"
                                x-transition:leave-start="opacity-100 scale-100"
                                x-transition:leave-end="opacity-0 scale-95"
                                class="absolute right-0 mt-2 w-48 bg-white shadow-lg rounded-lg border border-gray-200">
                                
                                <ul class="py-2">
                                    <li>
                                        <a th:href="@{#}" class="block px-4 py-2 text-black hover:bg-gray-100">
                                            시작하기
                                        </a>
                                    </li>
                                    <li>
                                        <a th:href="@{/user/changePassword}" class="block px-4 py-2 text-black hover:bg-gray-100">
                                            비밀번호 변경
                                        </a>
                                    </li>
                                    <li>
                                        <a th:href="@{/user/deleteAccount}" class="block px-4 py-2 text-black hover:bg-gray-100">
                                            회원탈퇴
                                        </a>
                                    </li>
                                    <li>
                                        <a th:href="@{/user/logout}" class="block px-4 py-2 text-red-600 hover:bg-gray-100">
                                            로그아웃
                                        </a>
                                    </li>
                                </ul>
                            </div>
                         
                        </div>
                    </div>
                </th:block>
                    
                </ul>
            </div>
        </div>
    </header>

    <!-- 광고 배너 -->
    <section class="flex justify-center items-center bg-gray-800 p-6 shadow-lg rounded-lg mt-6">
        <a href="https://www.advertisement-url.com" target="_blank">
            <img src="/images/ad-banner.jpg" alt="광고 배너" class="max-w-full h-auto rounded-lg shadow-md">
        </a>
    </section>

    <!-- 운동 동기부여 명언 영역 -->
    <section class="flex justify-center items-center mt-6">
        <div id="motivational-quote-section" class="bg-gray-800 shadow-lg rounded-lg p-6 w-full max-w-5xl text-center">
            <p id="motivational-quote" class="text-white">명언 로딩 중...</p>
        </div>
    </section>

    <!-- 트레이너 목록 -->
    <div class="flex flex-col items-center gap-6 w-full max-w-5xl mx-auto py-6">
        <section class="flex flex-col items-center p-8 shadow-lg rounded-lg w-full bg-gray-800">
            <h1 class="text-3xl font-bold text-white mb-6">트레이너 목록</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full">
                <div class="shadow-md rounded-lg overflow-hidden bg-white" th:each="trainer : ${trainers}">
                    <!-- 대표 이미지 (첫 번째 사진) or 기본 이미지 -->
                    <img th:src="${trainer.photos.size() > 0 ? trainer.photos[0].photoUrl : '/images/default-trainer.jpg'}" alt="Trainer Image" class="w-full h-48 object-cover">
                    
                    <div class="p-5 text-center bg-blue-100">
                        <h5 class="text-xl font-semibold text-gray-900" th:text="${trainer.user.userName}">트레이너 이름</h5>
                        <p class="text-gray-700" th:text="${trainer.specialization}">전문 분야</p>
                        <a th:href="@{/trainer/{id}(id=${trainer.trainerId})}" 
                           class="inline-block mt-4 bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition">
                            자세히 보기
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- 명언 API 호출 스크립트 -->
    <script>
        function loadMotivationalQuote() {
            fetch('/api/quote')
                .then(response => response.json())
                .then(data => {
                    document.getElementById("motivational-quote").innerText = data.quote;
                })
                .catch(error => {
                    console.error("명언 호출 중 오류:", error);
                    document.getElementById("motivational-quote").innerText = "명언을 불러오는 중 오류 발생.";
                });
        }
        
        // 페이지 로드 시 자동으로 명언 로딩
        window.onload = loadMotivationalQuote;
    </script>
</body>
</html>
